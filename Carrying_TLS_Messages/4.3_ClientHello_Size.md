---
title: "4.3. 客户端问候尺寸"
anchor: "4.3_ClientHello_Size"
weight: 430
rank: "h2"
---

The first Initial packet from a client contains the start or all of its first cryptographic handshake message, which for TLS is the ClientHello. Servers might need to parse the entire ClientHello (e.g., to access extensions such as Server Name Identification (SNI) or Application-Layer Protocol Negotiation (ALPN)) in order to decide whether to accept the new incoming QUIC connection. If the ClientHello spans multiple Initial packets, such servers would need to buffer the first received fragments, which could consume excessive resources if the client's address has not yet been validated. To avoid this, servers MAY use the Retry feature (see Section 8.1 of [QUIC-TRANSPORT]) to only buffer partial ClientHello messages from clients with a validated address.

来自客户端的首个初始数据包包含着客户端首个加密握手消息的所有部分或起始部分，对TLS来说这个消息就是客户端问候。客户端可能需要解析整个客户端问候（例如，为了访问服务器名称认证（SNI）和应用层协议协商（ALPN）等扩展）才能决定要不要接受这个新的传入QUIC连接。如果客户端问候横跨多个初始数据包，这样的服务器就需要缓存接收到的数据段，这会在客户端地址尚未被验证时消耗过多资源。为了避免这一情况，服务器{{< req_level MAY >}}使用重试特性（详见《[QUIC传输]()》的[第8.1章]()）以仅缓存来自具有经验证地址的客户端的客户端问候消息。

QUIC packet and framing add at least 36 bytes of overhead to the ClientHello message. That overhead increases if the client chooses a Source Connection ID field longer than zero bytes. Overheads also do not include the token or a Destination Connection ID longer than 8 bytes, both of which might be required if a server sends a Retry packet.

QUIC数据包和分帧过程会向客户端问候消息添加至少36字节的开销。如果客户端选择了长于零字节的源连接ID字段，那么这个开销还会增加。这个开销也不包含令牌字段和长于8字节的目标连接ID字段，当服务器发送重试数据包时会需要它们。

A typical TLS ClientHello can easily fit into a 1200-byte packet. However, in addition to the overheads added by QUIC, there are several variables that could cause this limit to be exceeded. Large session tickets, multiple or large key shares, and long lists of supported ciphers, signature algorithms, versions, QUIC transport parameters, and other negotiable parameters and extensions could cause this message to grow.

一个典型的TLS客户端问候可以被轻松地放进1200字节的数据包中。然而，除了由QUIC引入的开销之外，还有其他因素会使得客户端问候的尺寸超过这一限制。较大的会话票据、多个或较大的密钥共享值和较长的受支持的加密方法、签名算法、版本、QUIC传输参数或其他可协商参数与扩展的列表都可能使得这条消息变大。

For servers, in addition to connection IDs and tokens, the size of TLS session tickets can have an effect on a client's ability to connect efficiently. Minimizing the size of these values increases the probability that clients can use them and still fit their entire ClientHello message in their first Initial packet.

对服务器而言，除了连接ID和令牌外，TLS会话票据的尺寸也可能会影响客户端能否高效地进行连接。尽可能减小这些值的尺寸可以提高客户端使用它们并且仍可以将整个客户端问候消息放进首个初始数据包的可能性。

The TLS implementation does not need to ensure that the ClientHello is large enough to meet QUIC's requirements for datagrams that carry Initial packets; see Section 14.1 of [QUIC-TRANSPORT]. QUIC implementations use PADDING frames or packet coalescing to ensure that datagrams are large enough.

TLS实现不需要确保客户端问候的尺寸足够大从而满足QUIC对于传递初始数据包的数据报的要求；详见《[QUIC传输]()》的[第14.1章]()。QUIC实现会使用**填充帧**或数据包合并的方法来确保数据报足够大。
